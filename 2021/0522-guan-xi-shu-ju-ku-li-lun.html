<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="关系数据库理论, Shanecaiii">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>关系数据库理论 | Shanecaiii</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Shanecaiii" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Shanecaiii</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Shanecaiii</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/15.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">关系数据库理论</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/DataBase/">
                                <span class="chip bg-color">DataBase</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Notes/" class="post-category">
                                Notes
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2021-05-22
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="关系数据库规范化理论"><a href="#关系数据库规范化理论" class="headerlink" title="关系数据库规范化理论"></a>关系数据库规范化理论</h1><blockquote>
<p>如何使用关系模型设计关系数据库？也就是面对一个现实问题，如何选择一个比较好的关系模式的集合，每个关系又应该由哪些属性组成？这属于数据库设计的问题，确切地讲是数据库逻辑设计的问题。</p>
</blockquote>
<h2 id="规范化问题的提出"><a href="#规范化问题的提出" class="headerlink" title="规范化问题的提出"></a>规范化问题的提出</h2><ul>
<li>在关系数据库系统中，关系模型包括一组<strong>关系模式</strong>，各个关系不是完全孤立的，数据库的设计较层次和网状模型更为重要。</li>
<li>如何设计一个适合的关系数据库系统，关键是关系数据库模式的设计，一个好的关系数据库模式应该包括多少关系模式，而每一个关系模式又应该包括哪些属性，又如何将这些相互关联的关系模式组建一个适合的关系模型，这些工作决定了整个系统运行的效率，也是系统成败的关键所在，所以必须在关系数据库的<strong>规范化理论</strong>的指导下逐步完成。 </li>
</ul>
<p>关系数据库的规范化理论主要包括三个方面的内容：</p>
<ul>
<li>函数依赖</li>
<li>范式（Normal Form）</li>
<li>模式设计</li>
</ul>
<p>其中，函数信赖起着核心的作用，是模式分解和模式设计的基础，范式是模式分解的标准。</p>
<p>一个<strong>好的关系模式</strong>应该具备以下四个条件：</p>
<ul>
<li>尽可能少的数据冗余</li>
<li>没有插入异常</li>
<li>没有删除异常</li>
<li>没有更新异常</li>
</ul>
<p>如何按照一定的规范设计关系模式，将结构复杂的关系分解成结构简单的关系，从而把不好的关系数据库模式转变为好的关系数据库模式，这就是<strong>关系的规范化</strong>。</p>
<p>规范化又可以根据不同的要求而分成若干级别。</p>
<p>我们要设计的关系模式中的各属性是相互依赖、相互制约的，这样才构成了一个结构严谨的整体。</p>
<p>因此在设计关模式时，必须从语义上分析这些<strong>依赖关系</strong>。</p>
<p>数据库模式的好坏和关系中各属性间的依赖关系有关，因此，我们先讨论属性间的依赖关系，然后再讨论关系规范化理论。 </p>
<h2 id="函数依赖"><a href="#函数依赖" class="headerlink" title="函数依赖"></a>函数依赖</h2><h3 id="函数依赖的定义和性质"><a href="#函数依赖的定义和性质" class="headerlink" title="函数依赖的定义和性质"></a>函数依赖的定义和性质</h3><ul>
<li>关系模式中的各属性之间相互依赖、相互制约的联系称为<u>数据依赖</u>。</li>
<li>数据依赖一般分为<u>函数依赖、多值依赖和连接依赖</u>。</li>
<li>其中，<strong>函数依赖</strong>是最重要的数据依赖。</li>
</ul>
<p>函数依赖（Functional Dependency）是关系模式中属性之间的一种<strong>逻辑依赖关系</strong>。</p>
<blockquote>
<p>例如在上一节介绍的关系模式SCD中，SNO与SN、AGE、DEPT之间都有一种依赖关系。</p>
<p>由于一个SNO只对应一个学生，而一个学生只能属于一个系，所以当SNO的值确定之后，SN，AGE，DEPT的值也随之被唯一的确定了。</p>
<p>这类似于变量之间的单值函数关系。设单值函数Y=F(X)，自变量X的值可以决定一个唯一的函数值Y。</p>
<p>在这里，我们说SNO决定函数（SN，AGE，DEPT），或者说（SN，AGE，DEPT）函数依赖于SNO。</p>
</blockquote>
<h4 id="形式化定义"><a href="#形式化定义" class="headerlink" title="形式化定义"></a>形式化定义</h4><p>设关系模式R(U，F)，U是属性全集，F是U上的函数依赖集，X和Y是U的子集，如果对于R(U)的任意一个可能的关系r，<u>对于X的每一个具体值，Y都有唯一的具体值与之对应</u>，则称X决定函数Y，或Y函数依赖于X，记作X→Y。我们称X为决定因素，Y为依赖因素。</p>
<p><strong>几点说明：</strong></p>
<ol>
<li>平凡的函数依赖与非平凡的函数依赖。<ul>
<li>当属性集Y是属性集X的子集时，则必然存在着函数依赖X→Y,这种类型的函数依赖称为平凡的函数依赖。 （SNO，CNO）→SNO</li>
<li>如果Y不是X的子集，则称X→Y为非平凡的函数依赖。</li>
<li>若不特别声明，我们讨论的都是<u>非平凡的函数依赖</u>。</li>
</ul>
</li>
<li>函数依赖是语义范畴的概念。<ul>
<li>我们只能<strong>根据语义来确定</strong>一个函数依赖，而<strong>不能按照其形式化定义来证明</strong>一个函数依赖是否成立。</li>
<li>例如，对于关系模式S，当学生不存在重名的情况下，可以得到： SN→AGE SN→DEPT</li>
<li>这种函数依赖关系，必须是在没有重名的学生条件下才成立的，否则就不存在函数依赖了。所以函数依赖反映了一种语义完整性约束。</li>
</ul>
</li>
<li>函数依赖关系的存在与时间无关。<ul>
<li>因为函数依赖是指关系中的所有元组应该满足的约束条件，而不是指关系中某个或某些元组所满足的约束条件。</li>
<li>当关系中的元组增加、删除或更新后都不能破坏这种函数依赖。</li>
<li>因此，必须根据语义来确定属性之间的函数依赖，而<strong>不能单凭某一时刻关系中的实际数据值来判断</strong>。</li>
<li>例如，对于关系模式S，假设没有给出无重名的学生这种语义规定，则即使当前关系中没有重名的记录，也只能存在函数依赖SNO→SN，而不能存在函数依赖SN→SNO，因为如果新增加一个重名的学生，函数依赖SN→SNO必然不成立。</li>
<li>所以函数依赖关系的存在与时间无关，而只与数据之间的语义规定有关。 </li>
</ul>
</li>
<li>函数依赖可以保证关系分解的无损连接性。<ul>
<li>设R（X，Y，Z），X，Y，Z为不相交的属性集合，如果X→Y或X→Z，则有R(X，Y，Z) = R[X，Y] * R[X，Z]</li>
<li>其中，R[X，Y]表示关系R在属性（X，Y）上的投影，即R等于其投影在X上的自然连接，这样便保证了关系R分解后不会丢失原有的信息，称作<strong>关系分解的无损连接性</strong>。</li>
<li>例如，对于关系模式SCD，有SNO→（SN，AGE，DEPT，MN），SCD（SNO，SN，AGE，DEPT，MN，CNO，SCORE）=SCD[SNO，SN，AGE，DEPT，MN]*SCD[SNO，CNO，SCORE]，也就是说，用其投影在SNO上的自然连接可复原关系模式SCD。</li>
<li>这一性质非常重要，在后一节的关系规范化中要用到。 </li>
</ul>
</li>
</ol>
<h4 id="基本性质"><a href="#基本性质" class="headerlink" title="基本性质"></a>基本性质</h4><ol>
<li><p>投影性</p>
<ul>
<li>根据平凡的函数依赖的定义可知，一组属性函数决定它的所有子集。</li>
<li>例如，在关系SCD中，（SNO，CNO）→SNO和（SNO，CNO）→CNO。</li>
</ul>
</li>
<li><p>扩张性</p>
<ul>
<li>若X→Y且W→Z，则（X，W）→（Y，Z）。</li>
<li>例如，SNO→（SN，AGE），DEPT→MN，则有（SNO，DEPT）→（SN，AGE，MN）。</li>
</ul>
</li>
<li><p>合并性</p>
<ul>
<li>若X→Y且X→Z则必有X→（Y，Z）。</li>
<li>例如，在关系SCD中，SNO→（SN，AGE），SNO→（DEPT，MN），则有SNO→（SN，AGE，DEPT，MN）。</li>
</ul>
</li>
<li><p>分解性</p>
<p>若X→（Y，Z）,则X→Y且X→Z。很显然，<strong>分解性为合并性的逆过程</strong>。</p>
</li>
</ol>
<p>由合并性和分解性，很容易得到以下事实：</p>
<p>X→A1，A2，…，An成立的充分必要条件是X→Ai（i=1,2,…,n）成立。</p>
<h3 id="完全函数依赖与部分函数依赖"><a href="#完全函数依赖与部分函数依赖" class="headerlink" title="完全函数依赖与部分函数依赖"></a>完全函数依赖与部分函数依赖</h3><p>设关系模式R(U)，U是属性全集，X和Y是U的子集，</p>
<ul>
<li>如果X→Y，并且对于X的任何一个真子集X′，都有X′不→Y，则称Y对X完全函数依赖（Full Functional Dependency）。</li>
<li>如果对X的某个真子集X′，有X′→Y，则称Y对部分函数依赖（Partial Functional Dependency）。</li>
</ul>
<p>由上述定义可知：</p>
<ul>
<li>只有当决定因素是组合属性时，讨论部分函数依赖才有意义，</li>
<li>当决定因素是单属性时，只能是完全函数依赖。</li>
<li>例如，在关系模式S（SNO，SN，AGE，DEPT），决定因素为单属性SNO，有SNO→（SN，AGE，DEPT），不存在部分函数依赖。</li>
</ul>
<h3 id="传递函数依赖"><a href="#传递函数依赖" class="headerlink" title="传递函数依赖"></a>传递函数依赖</h3><p>设有关系模式R（U），U是属性全集，X，Y，Z是U的子集，</p>
<ul>
<li>若X→Y，Y→Z，这时如果Y→X，称Z对X直接函数依赖，而不是传递函数依赖。否则称Z对X传递函数依赖（Transitive Functional Dependency）。</li>
</ul>
<p>综上所述，函数依赖分为<u>完全函数依赖、部分函数依赖和传递函数依赖</u>三类，它们是规范化理论的依据和规范化程度的准则，下面我们将以介绍的这些概念为基础，进行数据库的规范设计。 </p>
<hr>
<h2 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h2><blockquote>
<p>规范化的基本思想是消除关系模式中的数据冗余，消除数据依赖中的不合适的部分，解决数据插入、删除时发生异常现象。这就要求关系数据库设计出来的关系模式要满足一定的条件。</p>
<p>我们把关系数据库的规范化过程中为不同程度的规范化要求设立的不同标准称为范式（Normal Form）。由于规范化的程度不同，就产生了不同的范式。</p>
<p>满足最基本规范化要求的关系模式叫第一范式（1NF），在第一范式中进一步满足一些要求为第二范式（3NF），以此类推就产生了第三范式（3NF）等概念。</p>
<p>每种范式都规定了一些限制约束条件。 </p>
</blockquote>
<h3 id="第一范式"><a href="#第一范式" class="headerlink" title="第一范式"></a>第一范式</h3><p>第一范式（First Normal Form）是最基本的规范形式，即关系中每个属性都是==不可再分==的简单项。</p>
<p><strong>定义：</strong>如果关系模式R，其所有的属性均为简单属性，即每个属性域都是不可再分的，则称R属于第一范式，简称1NF，记作R∈1NF。</p>
<ul>
<li>在讨论关系的性质时，我们把满足这个条件的关系称为规范化关系。</li>
<li>在关系数据库系统中只讨论规范化的关系，凡是非规范化的关系模式必须化成规范化的关系。</li>
<li>在非规范化的关系中去掉组合项就能化成规范化的关系。</li>
<li>每个规范化的关系都属于1NF，这也是它之所以称为“第一”的原因。</li>
</ul>
<h3 id="第二范式"><a href="#第二范式" class="headerlink" title="第二范式"></a>第二范式</h3><p><strong>定义：</strong>如果关系模式R∈1NF，且每个非主属性都==完全函数依赖于==R的每个关系键，则称R属于第二范式（Second Normal Form），简称2NF，记作R∈2NF。</p>
<p>在关系模式SCD中，SNO，CNO为主属性，AGE，DEPT，MN，SCORE均为非主属性，经上述分析，存在非主属性对关系键的部分函数依赖，所以SCD不是2NF。</p>
<blockquote>
<p>关系键的定义</p>
<p>设关系模式R的属性集是U，X是U的一个子集。如果X→U在R上成立，那么称X是R的一个超键。如果X→U在R上成立，但对于X的任一真子集X1都有X1→U不成立，那么称X是R上的一个候选键。可任意指定一个候选键为主键。在任一候选键中出现过的属性成为主属性。</p>
</blockquote>
<ol>
<li>从1NF关系中<strong>消除非主属性对关系键的部分函数依赖</strong>，则可得到2NF关系。</li>
<li>如果R的<strong>关系键为单属性</strong>，或R的<strong>全体属性均为主属性</strong>，则R∈2NF。</li>
</ol>
<h4 id="2NF规范化"><a href="#2NF规范化" class="headerlink" title="2NF规范化"></a><strong>2NF规范化</strong></h4><p>2NF规范化是指把1NF关系模式通过<u>投影分解</u>转换成2NF关系模式的集合。</p>
<p>分解时遵循的基本原则就是“一事一表”，让一个关系只描述一个实体或者实体间的联系。如果多于一个实体或联系，则进行投影分解。</p>
<h4 id="2NF的缺点"><a href="#2NF的缺点" class="headerlink" title="2NF的缺点"></a><strong>2NF的缺点</strong></h4><p>2NF的关系模式解决了1NF中存在的一些问题，2NF规范化的程度比1NF前进了一步，但2NF的关系模式在进行数据操作时，仍然存在着一些问题。这是由于在SCD中存在着非主属性对主键的传递依赖。为此，对关系模式SCD还需进一步简化，<strong>消除这种传递依赖</strong>，得到3NF。</p>
<h3 id="第三范式"><a href="#第三范式" class="headerlink" title="第三范式"></a>第三范式</h3><p><strong>定义：</strong>如果关系模式R∈2NF，且每个非主属性都==不传递依赖==于R的每个关系键，则称R属于第三范式（Third Normal Form），简称3NF，记作R∈3NF。</p>
<ol>
<li>如果R∈3NF，则R也是2NF。</li>
<li>如果R∈2NF，则R不一定是3NF。</li>
</ol>
<h4 id="3NF规范化"><a href="#3NF规范化" class="headerlink" title="3NF规范化"></a><strong>3NF规范化</strong></h4><p>3NF规范化是指把2NF关系模式通过<u>投影分解</u>转换成3NF关系模式的集合。</p>
<p>n和2NF的规范化时遵循的原则相同，即“一事一表”，让一个关系只描述一个实体或者实体间的联系。</p>
<ul>
<li>但是，3NF只限制了非主属性对键的依赖关系，而没有限制主属性对键的依赖关系。</li>
<li>如果发生了这种依赖，仍有可能存在数据冗余、插入异常、删除异常和修改异常。</li>
<li>这时，则需对3NF进一步规范化，<strong>消除主属性对键的依赖关系</strong>，为了解决这种问题，Boyce与Codd共同提出了一个新范式的定义，这就是Boyce-Codd范式，通常简称BCNF或BC范式。它弥补了3NF的不足。</li>
</ul>
<hr>
<h3 id="BC范式"><a href="#BC范式" class="headerlink" title="BC范式"></a>BC范式</h3><p><strong>定义：</strong>如果关系模式R∈1NF，且所有的函数依赖X→Y（Y 不∈X），决定因素X都包含了R的一个候选键，则称R属于BC范式（Boyce-Codd Normal Form），记作R∈BCNF。</p>
<ol>
<li>满足BCNF的关系将消除任何属性（主属性或非主属性）对键的部分函数依赖和传递函数依赖。也就是说，如果R∈BCNF，则R也是3NF。</li>
<li>如果R∈3NF，则R不一定是BCNF。</li>
</ol>
<h4 id="BCNF规范化"><a href="#BCNF规范化" class="headerlink" title="BCNF规范化"></a><strong>BCNF规范化</strong></h4><p>BCNF规范化是指把3NF关系模式通过投影分解转换成BCNF关系模式的集合。</p>
<p>==下面以3NF关系模式SNC为例，来说明BCNF规范化的过程。==</p>
<p>例　将SNC(SNO，SN，CNO，SCORE)规范到BCNF。</p>
<ul>
<li>分析SNC数据冗余的原因，是因为在这一个关系中存在两个实体，一个为学生实体，属性有SNO、SN；另一个是选课实体，属性有SNO、CNO和SCORE。</li>
<li>根据分解的原则，我们可以将SNC分解成如下两个关系：<ul>
<li>S1(SNO，SN)，描述学生实体；</li>
<li>S2(SNO，CNO，SCORE)，描述学生与课程的联系。</li>
</ul>
</li>
<li>对于S1，有两个候选键SNO和SN，对于S2，主键为（SNO，CNO）。</li>
<li>在这两个关系中，无论主属性还是非主属性都不存在对键的部分依赖和传递依赖，S1∈BCNF，S2∈BCNF。</li>
</ul>
<hr>
<p>如果一个关系数据库中所有关系模式都属于3NF，则已在很大程度上消除了插入异常和删除异常，但由于可能存在主属性对候选键的部分依赖和传递依赖，因此关系模式的分离仍不够彻底。</p>
<p>如果一个关系数据库中所有关系模式都属于BCNF，那么在函数依赖的范畴内，已经实现了模式的彻底分解，消除了产生插入异常和删除异常的根源，而且数据冗余也减少到极小程度。 </p>
<h2 id="关系模式的规范化"><a href="#关系模式的规范化" class="headerlink" title="关系模式的规范化"></a>关系模式的规范化</h2><blockquote>
<p>到目前为止，规范化理论已经提出了六类范式（有关4NF和5NF的内容不再详细介绍）。</p>
<p>各范式级别是在分析函数依赖条件下对关系模式分离程度的一种测度，范式级别可以逐级升高。</p>
<p>一个低一级范式的关系模式，通过模式分解转化为若干个高一级范式的关系模式的集合，这种分解过程叫作关系模式的规范化（Normalization）。</p>
</blockquote>
<h3 id="关系模式规范化的目的和原则"><a href="#关系模式规范化的目的和原则" class="headerlink" title="关系模式规范化的目的和原则"></a>关系模式规范化的目的和原则</h3><p>一个关系只要其分量都是不可分的数据项，就可称作规范化的关系，但这只是最基本的规范化。这样的关系模式是合法的。但人们发现有些关系模式存在插入、删除、修改异常、数据冗余等弊病。</p>
<p><strong>规范化的目的就是使结构合理，消除存储异常，使数据冗余尽量小，便于插入、删除和更新</strong>。 </p>
<ul>
<li>规范化的基本原则就是遵从概念单一化“一事一表”的原则，即一个关系只描述一个实体或者实体间的联系。</li>
<li>若多于一个实体，就把它“分离”出来。</li>
<li>因此，所谓规范化，实质上是概念的单一化，即一个关系表示一个实体。</li>
</ul>
<h3 id="关系模式规范化的步骤"><a href="#关系模式规范化的步骤" class="headerlink" title="关系模式规范化的步骤"></a>关系模式规范化的步骤</h3><p>规范化就是对原关系进行投影，消除决定属性不是候选键的任何函数依赖。具体可以分为以下几步：</p>
<ol>
<li>对1NF关系进行投影，消除原关系中非主属性对键的部分函数依赖，将1NF关系转换成若干个2NF关系。</li>
<li>对2NF关系进行投影，消除原关系中非主属性对键的传递函数依赖，将2NF关系转换成若干个3NF关系。</li>
<li>对3NF关系进行投影，消除原关系中主属性对键的部分函数依赖和传递函数依赖，也就是说使决定因素都包含一个候选键。得到一组BCNF关系。</li>
</ol>
<p><img src="https://imgtu.com/i/gL1zrt" alt="规范化过程"></p>
<ul>
<li>一般情况下，我们说没有异常弊病的数据库设计是好的数据库设计，一个不好的关系模式也总是可以通过分解转换成好的关系模式的集合。</li>
<li>但是在分解时要全面衡量，综合考虑，视实际情况而定。</li>
<li>对于那些只要求查询而不要求插入、删除等操作的系统，几种异常现象的存在并不影响数据库的操作。这时便不宜过度分解，否则当要对整体查询时，需要更多的多表连接操作，这有可能得不偿失。****</li>
<li>在实际应用中，最有价值的是3NF和BCNF，在进行关系模式的设计时，通常分解到3NF就足够了。 </li>
</ul>
<h3 id="关系模式规范化的要求"><a href="#关系模式规范化的要求" class="headerlink" title="关系模式规范化的要求"></a>关系模式规范化的要求</h3><ul>
<li>关系模式的规范化过程是通过对关系模式的投影分解来实现的，但是投影分解方法不是唯一的，不同的投影分解会得到不同的结果。</li>
<li>在这些分解方法中，只有能够保证分解后的关系模式与原关系模式等价的方法才是有意义的。</li>
</ul>
<p><strong>无损连接性（Lossless Join）函数依赖保持性（Preserve Dependency）</strong></p>
<p>判断分解具有无损连接性的方法</p>
<ol>
<li><p>定理判别法 (适合关系模式R分解为两个关系模式R1、R2时)</p>
<p>若关系模式R&lt;U,F&gt;中，被分解为p={R1&lt;U1,F1&gt;, R2&lt;U2,F2&gt;}是R的一个分解，若R1∩R2 → R1 - R2或者R1∩R2 → R2 - R1，则称p具有无损连接性</p>
<p>示例：已知R&lt;U,F&gt;,U={A,B,C}，F={B-&gt;C},R的一个分解为R1(A,B)，R2(B,C)</p>
<p> 解：R1∩R2 为B，R2-R1为C,因为B-&gt;C，因此分解是无损连接</p>
<blockquote>
<p>理解：相交的部分能够唯一确定相差的部分得到分解前完整的表</p>
</blockquote>
</li>
<li><p>列表法</p>
<ul>
<li>构造一个k行n列的二维表T，第i行对应于一个关系模式Ri，第j列对应于属性Aj，令：tij=aj，若Aj属于Ri；否则tij=bij。</li>
<li>对于F中一个FD：X→Y，如果表格中有两行在X分量上相等，在Y分量上不相等，那么把这两行在Y分量上改成相等。如果Y的分量中有一个是aj，那么另一个也改成aj；如果没有aj，那么用其中的一个bij替换另一个(尽量把ij改成较小的数，亦即取i值较小的那个)</li>
<li>若在修改的过程中，发现表格中有一行全是a，即a1,a2,…,an，那么可立即断定p相对于F是无损连接分解，此时不必再继续修改。若经过多次修改直到表格不能修改之后，发现表格中不存在有一行全是a的情况，那么分解就是有损的。特别要注意，这里有个循环反复修改的过程，因为一次修改可能导致表格能继续修改。</li>
</ul>
</li>
</ol>
<p>判断对关系模式的一个分解是否与原关系模式等价可以有三种不同的标准：</p>
<ol>
<li>分解要具有无损连接性。</li>
<li>分解要具有函数依赖保持性。</li>
<li>分解既要具有无损连接性，又要具有函数依赖保持性。</li>
</ol>
<ul>
<li>如果一个分解具有无损连接性，则能够保证不丢失信息。如果一个分解具有函数依赖保持性，则可以减轻或解决各种异常情况。</li>
<li>分解具有无损连接性和函数依赖保持性是两个相互独立的标准。具有无损连接性的分解不一定具有函数依赖保持性。同样，具有函数依赖保持性的分解也不一定具有无损连接性。</li>
<li>规范化理论提供了一套完整的模式分解方法，按照这套算法可以做到：如果要求分解既具有无损连接性，又具有函数依赖保持性，则<strong>分解一定能够达到3NF，但不一定能够达到BCNF</strong>。</li>
<li>所以在3NF的规范化中，既要<strong>检查分解是否具有无损连接性，又要检查分解是否具有函数依赖保持性</strong>。只有这两条都满足，才能保证分解的正确性和有效性，才既不会发生信息丢失，又保证关系中的数据满足完整性约束。 </li>
</ul>
<h2 id="非规范化设计"><a href="#非规范化设计" class="headerlink" title="非规范化设计"></a>非规范化设计</h2><blockquote>
<p>许多数据库应用强调性能优先</p>
<p>规范化设计有时会导致数据库运行效率的下降</p>
<p>非规范化设计：在特殊条件和要求下，适当地降低甚至抛弃关系模式的范式，不再要求一个表只描述一个实体或者实体间的一种联系。其主要目的在于提高数据库的运行效率。</p>
</blockquote>
<p>一般认为，在下列情况下可以考虑进行非规范化处理：</p>
<ul>
<li>大量频繁的查询过程所涉及的表都需要进行连接;</li>
<li>主要的应用程序在执行时要将表连接起来进行查询；</li>
<li>对数据的计算需要临时表或进行复杂的查询。 </li>
</ul>
<p>非规范化处理的主要技术包括<strong>增加冗余或派生列，对表进行合并、分割或增加重复表</strong>。</p>
<ul>
<li>增加冗余列是指在多个表中具有相同的列，它常用来在查询时避免连接操作，但它需要更多的磁盘空间，同时增加表维护的工作量。 </li>
<li>增加派生列指增加的列来自其它表中的数据，由它们计算生成。它的作用是在查询时减少连接操作，避免使用集函数。派生列也具有与冗余列同样的缺点。</li>
<li>重新组表指如果许多用户需要查看两个表连接出来的结果数据，则把这两个表重新组成一个表来减少连接而提高性能。这样可提高性能，但需要更多的磁盘空间，同时也损失了数据在概念上的独立性。 </li>
</ul>
<p>有时<strong>对表做分割</strong>可以提高性能：</p>
<ul>
<li><p>水平分割</p>
<p>根据一列或多列数据的值把数据行放到两个独立的表中。水平分割通常在下面的情况下使用。</p>
<ul>
<li>表很大，分割后可以降低在查询时需要读的数据和索引的页数，同时也降低了索引的层数，提高查询速度。</li>
<li>表中的数据本来就有独立性，例如表中分别记录各个地区的数据或不同时期的数据，特别是有些数据常用，而另外一些数据不常用。</li>
<li>需要把数据存放到多个介质上。</li>
</ul>
<p>水平分割会给应用增加复杂度，它通常在查询时需要多个表名，查询所有数据需要union操作。在许多数据库应用中，这种复杂性会超过它带来的优点。</p>
</li>
<li><p>垂直分割</p>
<p>把主键和一些列放到一个表，然后把主键和另外的列放到另一个表中。</p>
<p>如果一个表中某些列常用，而另外一些列不常用，则可以采用垂直分割加快查询速度。其缺点是需要管理冗余列，查询所有数据需要join操作。</p>
</li>
</ul>
<p><strong>非规范化设计的主要优点</strong></p>
<ol>
<li>减少了查询操作所需的连接</li>
<li>减少了外部键和索引的数量</li>
<li>可以预先进行统计计算，提高了查询时的响应速度</li>
</ol>
<p><strong>非规范化存在的主要问题</strong></p>
<ol>
<li>增加了数据冗余</li>
<li>影响数据库的完整性</li>
<li>降低了数据更新的速度</li>
<li>增加了存储表所占用的物理空间</li>
</ol>
<p>无论使用何种非规范化技术，都需要一定的管理来维护数据的完整性</p>
<p>管理方式有很多，最好的是用<strong>触发器</strong>来实现。对数据的任何修改立即触发对复制列或派生列的相应修改。触发器是实时的，而且相应的处理逻辑只在一个地方出现，易于维护。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>在这一章，我们首先由关系模式的存储异常问题引出了函数依赖的概念，其中包括完全函数依赖、部分函数依赖和传递函数依赖，这些概念是规范化理论的依据和规范化程度的准则。</p>
<p>规范化就是对原关系进行投影，消除决定属性不是候选键的任何函数依赖。</p>
<p>一个关系只要其分量都是<strong>不可分</strong>的数据项，就可称作规范化的关系，也称作1NF。</p>
<p>消除1NF关系中<strong>非主属性对键的部分函数依赖</strong>，得到2NF，消除2NF关系中<strong>非主属性对键的传递函数依赖</strong>，得到3NF，消除3NF关系中<strong>主属性对键的部分函数依赖和传递函数依赖</strong>，便可得到一组BCNF关系。</p>
<p>在规范化过程中，逐渐消除存储异常，使数据冗余尽量小，便于插入、删除和更新。</p>
<p>规范化的基本原则就是遵从概念单一化“一事一地”的原则，即一个关系只描述<strong>一个实体或者实体间</strong>的联系。</p>
<p>规范化的<strong>投影分解方法不是唯一的</strong>，对于3NF的规范化，分解既要具有无损连接性，又要具有函数依赖保持性。</p>
<p>规范化设计会导致<strong>数据库性能下降</strong>。可以<strong>适当引入非规范化设计</strong>以取得性能上的提高，但需进行精心的数据维护以消除可能带来的数据管理异常</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Ashane</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://Sasuke7chen.github.io/2021/0522-guan-xi-shu-ju-ku-li-lun.html">http://Sasuke7chen.github.io/2021/0522-guan-xi-shu-ju-ku-li-lun.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">Ashane</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/DataBase/">
                                    <span class="chip bg-color">DataBase</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;Current
            </div>
            <div class="card">
                <a href="/2021/0522-guan-xi-shu-ju-ku-li-lun.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="关系数据库理论">
                        
                        <span class="card-title">关系数据库理论</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-05-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Notes/" class="post-category">
                                    Notes
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/DataBase/">
                        <span class="chip bg-color">DataBase</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/0504-xian-xing-lian-biao-de-ji-ben-suan-fa.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="线性链表的基本算法">
                        
                        <span class="card-title">线性链表的基本算法</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-05-04
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Summary/" class="post-category">
                                    Summary
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Data-Structure/">
                        <span class="chip bg-color">Data Structure</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">Ashane</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/Sasuke7chen" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:a1027876185@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1027876185" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1027876185" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="https://weibo.com/6755585328" class="tooltipped" target="_blank" data-tooltip="关注我的微博" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>





    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
